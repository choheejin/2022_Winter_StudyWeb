<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="preconnect" href="https://fonts.gstatic.com" />
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@100;300;400;500;700;900&display=swap"
    rel="stylesheet" />
  <link rel="stylesheet" href="reset.css" />
  <link rel="stylesheet" href="style.css" />
  <title>영화 별점 평가하기</title>
</head>

<body>
  <div id="warp">
    <div id="img1">
      <img src="images/poster_bootcamp.png" width="250">
    </div>


    <div id="content">
      <div id="text">
        <ul>
          <li>드라마</li>
          <li>|</li>
          <li>전체이용가</li>
        </ul>
        <h1>파이썬 부트캠프</h1>

        <span class="evl" id="thumbsBack" onclick="clickThumbs();">
          <img src="images/icon_thumbs_up.png" id="thumbs" width="25">
        </span>
        <span class="evl" id="heartBack" onclick="clickHeart()">
          <img src="images/icon_heart.png" id="heart" width="25">
        </span>
        <p>별점 평균 4.5</p>

        <div id="group">
          <span class="star">
            <img src="images/icon_empty_star.png" id="s0" onmousemove="OnMouseMove(this)" onclick="fixStar(this)" width="40" alt="">
          </span>
          <span class="star">
            <img src="images/icon_empty_star.png" id="s1" onmousemove="OnMouseMove(this)" onclick="fixStar(this)" width="40" alt="">
          </span>
          <span class="star">
            <img src="images/icon_empty_star.png" id="s2" onmousemove="OnMouseMove(this)" onclick="fixStar(this)" width="40" alt="">
          </span>
          <span class="star">
            <img src="images/icon_empty_star.png" id="s3" onmousemove="OnMouseMove(this)" onclick="fixStar(this)" width="40" alt="">
          </span>
          <span class="star">
            <img src="images/icon_empty_star.png" id="s4" onmousemove="OnMouseMove(this)" onclick="fixStar(this)" width="40" alt="">
          </span>

          <img src="images/icon_remove_star.png" onclick="reset()" style="padding: 10px 2px;">

          <script>
            var flag = false;
            function fillStar(elem) {
              var standard = elem.getAttribute('id');
              var i = 0;
              var target = "";
              while (standard !== target) {
                target = "s" + i;
                document.getElementById(target).src = "images/icon_star.png";
                i++;
              }
            }

            function fixStar(elem){
              flag = true;
            }

            function OnMouseMove(elem) {
              if(flag==true){
                console.log("클릭")
                return false;
              } else{
                let x = event.offsetX;
                let y = event.offsetY;
                let x2 = event.clientX;

                console.log(x, x2);
                fillStar(elem);

                if (y >= 30 || y <= 10 ) {
                  console.log("ehla")
                  resetStar(elem);
                } else {
                  if (x <= 25 && x > 10)
                    elem.src = "images/icon_half_star.png";
                  else if (x <= 10 || x > 33) {
                    elem.src = "images/icon_empty_star.png";
                    resetStar(elem);
                  }
                  else
                    elem.src = "images/icon_star.png";
                  console.log(x, y);
                }
              }
            }

            function resetStar(elem) {
              var standard = elem.getAttribute('id');
              var i = parseInt(standard.substr(standard.length - 1));
              var target = "";
              console.log("reset" + standard, target)
              while (i !== -1) {
                target = "s" + i;
                document.getElementById(target).src = "images/icon_empty_star.png";
                i--;
              }
            }

            function reset() {
              flag = false;
              var i = 4;
              var target = "";
              while (i !== -1) {
                target = "s" + i;
                console.log(target);
                document.getElementById(target).src = "images/icon_empty_star.png";
                i--;
              }
            }

            function clickThumbs() {
              if (document.getElementById('thumbsBack').style.backgroundColor == "rgb(53, 135, 242)") {
                document.getElementById('thumbsBack').style.backgroundColor = "transparent";
                document.getElementById('thumbs').src = "images/icon_thumbs_up.png"
              }
              else {
                document.getElementById('thumbsBack').style.backgroundColor = "rgb(53, 135, 242)";
                document.getElementById('thumbs').src = "images/icon_thumbs_up_fill.png"
              }
            }

            function clickHeart() {
              if (document.getElementById('heartBack').style.backgroundColor == "rgb(242, 92, 92)") {
                document.getElementById('heartBack').style.backgroundColor = "transparent";
                document.getElementById('heart').src = "images/icon_heart.png"
              }
              else {
                document.getElementById('heartBack').style.backgroundColor = "rgb(242, 92, 92)";
                document.getElementById('heart').src = "images/icon_heart_fill.png"
              }
            }
          </script>
        </div>

      </div>

    </div>
  </div>

</body>

</html>